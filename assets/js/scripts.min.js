"use strict";!function(t){var o,e,n,i,a=1e3*ina_ajax.settings.timeout,s=0,r=ina_ajax.settings.countdown_timeout,c=ina_ajax.ajaxurl,l={onReady:function(){this.setupDOM(),this.eventListeners()},setupDOM:function(){},eventListeners:function(){e=sessionStorage.inactive_logout_tabID&&"2"!==sessionStorage.closedLastTab?sessionStorage.inactive_logout_tabID:sessionStorage.inactive_logout_tabID=Math.random(),sessionStorage.closedLastTab="2",window.addEventListener("beforeunload",function(t){sessionStorage.closedLastTab="1"}),localStorage.setItem("ina__browserTabID",e),t(document).on("mousemove",this.resetTimer.bind(this)),t(document).on("mousedown",this.resetTimer.bind(this)),t(document).on("keydown",this.resetTimer.bind(this)),t(document).on("DOMMouseScroll",this.resetTimer.bind(this)),t(document).on("mousewheel",this.resetTimer.bind(this)),t(document).on("touchmove",this.resetTimer.bind(this)),t(document).on("MSPointerMove",this.resetTimer.bind(this)),t(document).ready(this.resetTimer.bind(this)),t(document).on("click",".ina_stay_logged_in",this.stayLoggedInWarnMsg),t(document).on("click",".btn-close-without-reload",this.stayLoggedInWarnMsg),this.startTimer()},startTimer:function(){o=setTimeout(l.goInactive.bind(this),11e3)},resetTimer:function(){clearTimeout(o),clearTimeout(n),localStorage.setItem("ina__browserTabID",e);try{this.startTimer()}catch(t){TypeError,console.log(t,!0)}},goInactive:function(){var o=this;if(0===s){var i=localStorage.getItem("ina__browserTabID");if(parseFloat(i)===parseFloat(e)){var r=Date.now(),u=Math.floor(r/1e3),_={action:"ina_checklastSession",do:"ina_updateLastSession",security:ina_ajax.ina_security,timestamp:u};t.post(c,_).done(function(t){if(!1!==t.success){var e=document.activeElement;if(e&&("IFRAME"===e.tagName||e.classList.contains("media-modal")))return o.resetTimer(),!1;n=setTimeout(function(){l.showTimeoutMessage(t)},a)}})}}},showTimeoutMessage:function(o){var e,n=ina_ajax.settings.disable_countdown,a=ina_ajax.settings.warn_message_enabled;if(document.onkeydown=function(t){if(116!=(t.charCode||t.keyCode))return!1},window.oncontextmenu=function(){return!1},s=1,a)t("#ina__dp_logout_message_box").show().html(o.html);else if(n){var u={action:"ina_checklastSession",do:"ina_logout",security:ina_ajax.ina_security};t.post(c,u).done(function(e){if(e.redirect_url)t("#ina__dp_logout_message_box").show().html(o.html),t("#ina__dp_logout_message_box .ina-dp-noflict-modal-body").html("<p>"+e.msg+"<p>"),l.logout_now(e.redirect_url);else{var n=ina_ajax.is_admin?'<a class="btn-close-without-reload" style="margin-left:10px;" href="javascript:void(0);">'+ina_ajax.i10n.close+"</a>":"";t("#ina__dp_logout_message_box").show().html(o.html),t("#ina__dp_logout_message_box .ina-dp-noflict-modal-body").html("<p>"+e.msg+'</p><p class="ina-dp-noflict-btn-container"><a class="btn-timeout" href="javascript:void(0);" onclick="window.location.reload();">'+ina_ajax.i10n.ok+"</a>"+n+"</p>"),l.logout_now(!1)}return!1})}else r=ina_ajax.settings.countdown_timeout,t("#ina__dp_logout_message_box").show().html(o.html),i=setInterval(function(){if(r>=0&&(e=r--,t(".ina_countdown").html("("+e+")")),0===e){clearTimeout(i);var o={action:"ina_checklastSession",do:"ina_logout",security:ina_ajax.ina_security};t.post(c,o).done(function(o){if(o.redirect_url)t("#ina__dp_logout_message_box .ina-dp-noflict-modal-body").html("<p>"+o.msg+"<p>"),l.logout_now(o.redirect_url);else{var e=ina_ajax.is_admin?'<a class="btn-close-without-reload" style="margin-left:10px;" href="javascript:void(0);">'+ina_ajax.i10n.close+"</a>":"";t("#ina__dp_logout_message_box .ina-dp-noflict-modal-body").html("<p>"+o.msg+'</p><p class="ina-dp-noflict-btn-container"><a class="btn-timeout" href="javascript:void(0);" onclick="window.location.reload();">'+ina_ajax.i10n.ok+"</a>"+e+"</p>"),l.logout_now(!1)}return!1})}},1e3)},stayLoggedInWarnMsg:function(){document.onkeydown=function(t){return!0},window.oncontextmenu=null,clearTimeout(i),r=ina_ajax.settings.countdown_timeout,s=0,t("#ina__dp_logout_message_box").hide(),t(".ina_countdown").text("")},logout_now:function(e){var n={action:"ina_logout_session",security:ina_ajax.ina_security};t.post(c,n).done(function(){clearTimeout(o),localStorage.removeItem("ina__browserTabID"),e&&(window.location=e),ina_ajax.is_admin&&t(document).trigger("heartbeat-tick.wp-auth-check",[{"wp-auth-check":!1}]),console.log("Session Logged Out !!")})}};t(function(){l.onReady()})}(jQuery);