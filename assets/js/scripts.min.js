"use strict";!function(a){var e,t,n,i,s=1e3*ina_ajax.settings.timeout,r=0,c=10,l=ina_ajax.ajaxurl,u={onReady:function(){this.setupDOM(),this.eventListeners()},setupDOM:function(){},eventListeners:function(){t=sessionStorage.inactive_logout_tabID&&"2"!==sessionStorage.closedLastTab?sessionStorage.inactive_logout_tabID:sessionStorage.inactive_logout_tabID=Math.random(),sessionStorage.closedLastTab="2",window.addEventListener("beforeunload",function(o){o.preventDefault(),sessionStorage.closedLastTab="1"}),localStorage.setItem("ina__browserTabID",t),a(document).on("mousemove",this.resetTimer.bind(this)),a(document).on("mousedown",this.resetTimer.bind(this)),a(document).on("keydown",this.resetTimer.bind(this)),a(document).on("DOMMouseScroll",this.resetTimer.bind(this)),a(document).on("mousewheel",this.resetTimer.bind(this)),a(document).on("touchmove",this.resetTimer.bind(this)),a(document).on("MSPointerMove",this.resetTimer.bind(this)),a(document).on("ready",this.resetTimer.bind(this)),a(document).on("click",".ina_stay_logged_in",this.stayLoggedInWarnMsg),a(document).on("click",".btn-close-without-reload",this.stayLoggedInWarnMsg),this.startTimer()},startTimer:function(){e=setTimeout(u.goInactive,11e3)},resetTimer:function(){clearTimeout(e),clearTimeout(n),localStorage.setItem("ina__browserTabID",t);try{this.startTimer()}catch(o){TypeError,console.log(o,!0)}},goInactive:function(){var o,e=this;0===r&&(o=localStorage.getItem("ina__browserTabID"),console.log(o),console.log(t),parseFloat(o)===parseFloat(t)&&(o=Date.now(),o=Math.floor(o/1e3),o={action:"ina_checklastSession",do:"ina_updateLastSession",security:ina_ajax.ina_security,timestamp:o},a.post(l,o).done(function(o){if(!1!==o.success){var t=document.activeElement;if(t&&("IFRAME"===t.tagName||t.classList.contains("media-modal")))return e.resetTimer(),!1;n=setTimeout(function(){e.showTimeoutMessage(o)},s)}})))},showTimeoutMessage:function(e){var t,o=ina_ajax.settings.disable_countdown,n=ina_ajax.settings.warn_message_enabled;document.onkeydown=function(o){if(116!=(o.charCode||o.keyCode))return!1},window.oncontextmenu=function(){return!1},r=1,n?a("#ina__dp_logout_message_box").show().html(e.html):o?(o={action:"ina_checklastSession",do:"ina_logout",security:ina_ajax.ina_security},a.post(l,o).done(function(o){var t;return o.redirect_url?(a("#ina__dp_logout_message_box").show().html(e.html),a("#ina__dp_logout_message_box .ina-dp-noflict-modal-body").html("<p>"+o.msg+"<p>"),u.logout_now(o.redirect_url)):(t=ina_ajax.is_admin?'<a class="btn-close-without-reload" style="margin-left:10px;" href="javascript:void(0);">'+ina_ajax.i10n.close+"</a>":"",a("#ina__dp_logout_message_box").show().html(e.html),a("#ina__dp_logout_message_box .ina-dp-noflict-modal-body").html("<p>"+o.msg+'</p><p class="ina-dp-noflict-btn-container"><a class="btn-timeout" href="javascript:void(0);" onclick="window.location.reload();">'+ina_ajax.i10n.ok+"</a>"+t+"</p>"),u.logout_now(!1)),!1})):(c=10,a("#ina__dp_logout_message_box").show().html(e.html),i=setInterval(function(){var o;0<=c&&(t=c--,a(".ina_countdown").html("("+t+")")),0===t&&(clearTimeout(i),o={action:"ina_checklastSession",do:"ina_logout",security:ina_ajax.ina_security},a.post(l,o).done(function(o){var t;return o.redirect_url?(a("#ina__dp_logout_message_box .ina-dp-noflict-modal-body").html("<p>"+o.msg+"<p>"),u.logout_now(o.redirect_url)):(t=ina_ajax.is_admin?'<a class="btn-close-without-reload" style="margin-left:10px;" href="javascript:void(0);">'+ina_ajax.i10n.close+"</a>":"",a("#ina__dp_logout_message_box .ina-dp-noflict-modal-body").html("<p>"+o.msg+'</p><p class="ina-dp-noflict-btn-container"><a class="btn-timeout" href="javascript:void(0);" onclick="window.location.reload();">'+ina_ajax.i10n.ok+"</a>"+t+"</p>"),u.logout_now(!1)),!1}))},1e3))},stayLoggedInWarnMsg:function(){document.onkeydown=function(o){return!0},window.oncontextmenu=null,clearTimeout(i),c=10,r=0,a("#ina__dp_logout_message_box").hide(),a(".ina_countdown").text("")},logout_now:function(o){var t={action:"ina_logout_session",security:ina_ajax.ina_security};a.post(l,t).done(function(){clearTimeout(e),o&&(localStorage.removeItem("ina__browserTabID"),window.location=o),ina_ajax.is_admin&&a(document).trigger("heartbeat-tick.wp-auth-check",[{"wp-auth-check":!1}]),console.log("Session Logged Out !!")})}};a(function(){u.onReady()})}(jQuery);